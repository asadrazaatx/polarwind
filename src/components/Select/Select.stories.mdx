import { useState } from "react";
import {
  Meta,
  Story,
  Props,
  Description,
  Preview,
} from "@storybook/addon-docs/blocks";
import { withSmartKnobs } from "storybook-addon-smart-knobs";
import { Select } from "./Select";
import { FormLayout } from "../FormLayout";

<Meta
  title="Components / Forms / Select"
  component={Select}
  decorators={[
    withSmartKnobs({ ignoreProps: ["children", "value", "helpText"] }),
  ]}
/>

# Select

<Description of={Select} />

<Preview withToolbar>
  <Story name="Example">
    {() => {
      const [value, setValue] = useState("m");
      const helpText = <>Current value is {value}</>;
      const options = [
        { label: "Small", value: "s" },
        { label: "Medium", value: "m" },
        { label: "Large", value: "l" },
      ];
      return (
        <>
          <Select
            label="Size"
            options={options}
            value={value}
            onChange={setValue}
            helpText={helpText}
          />
        </>
      );
    }}
  </Story>
</Preview>

<Props of={Select} />

## Usage

### Default select

Presents a classic dropdown menu or equivalent picker as determined by users browsers.

### Options

Accepts options in various formats.

#### String arrays

The simplest way to define options. It will use the string as both the label and value.

<Preview>
  <Story name="String array">
    {() => {
      const [value, setValue] = useState("Two");
      const helpText = <>Current value is {value}</>;
      const options = ["One", "Two", "Three"];
      return (
        <>
          <Select
            label="Size"
            options={options}
            value={value}
            onChange={setValue}
            helpText={helpText}
          />
        </>
      );
    }}
  </Story>
</Preview>

#### `label` and `value` object arrays

The typical format where your value is different than your display label, usually an ID.
Also supports a `disabled` attribute.

<Preview>
  <Story name="Label and value">
    {() => {
      const [value, setValue] = useState("xl");
      const helpText = <>Current value is {value}</>;
      const options = [
        { label: "Small", value: "s" },
        { label: "Medium", value: "m" },
        { label: "Large", value: "l", disabled: true },
        { label: "Extra large", value: "xl" },
      ];
      return (
        <Select
          label="Size"
          options={options}
          value={value}
          onChange={setValue}
          helpText={helpText}
        />
      );
    }}
  </Story>
</Preview>

#### Option groups

<Preview>
  <Story name="Option groups">
    {() => {
      const [value, setValue] = useState("Three");
      const helpText = <>Current value is {value}</>;
      const options = [
        {
          title: "String array",
          options: ["One", "Two", "Three"],
        },
        {
          title: "Label/value array",
          options: [
            { label: "Small", value: "s" },
            { label: "Medium", value: "m" },
            { label: "Large", value: "l", disabled: true },
            { label: "Extra large", value: "xl" },
          ],
        },
      ];
      return (
        <Select
          label="Size"
          options={options}
          value={value}
          onChange={setValue}
          helpText={helpText}
        />
      );
    }}
  </Story>
</Preview>

### Validation error

<Preview>
  <Story name="Error">
    <Select
      label="Size"
      value=""
      options={[
        { label: "Select a size", value: "" },
        { label: "Small", value: "s" },
        { label: "Medium", value: "m" },
        { label: "Large", value: "l" },
      ]}
      error="You must choose a size"
    />
  </Story>
</Preview>

### Disabled

<Preview>
  <Story name="Disabled">
    <Select
      label="Size"
      options={[
        { label: "Small", value: "s" },
        { label: "Medium", value: "m" },
        { label: "Large", value: "l" },
      ]}
      disabled
    />
  </Story>
</Preview>

### Hidden label

<Preview>
  <Story name="Hidden label">
    <Select
      label="Size"
      labelHidden
      options={[
        { label: "Small", value: "s" },
        { label: "Medium", value: "m" },
        { label: "Large", value: "l" },
      ]}
    />
  </Story>
</Preview>

### Menu widths

<Preview>
  <Story name="Option width and placement">
    <FormLayout>
      <FormLayout.Group>
        <Select
          label="Size"
          labelHidden
          options={[
            { label: "Small", value: "s" },
            { label: "Medium", value: "m" },
            { label: "Large", value: "l" },
          ]}
        />
        <Select
          label="Country"
          labelHidden
          options={[
            {
              label: "United Kingdom of Great Britain and Northern Ireland",
              value: "uk",
            },
            { label: "USA", value: "us" },
          ]}
        />
        <Select label="Color" labelHidden options={["Red", "Green", "Blue"]} />
      </FormLayout.Group>
    </FormLayout>
  </Story>
</Preview>
